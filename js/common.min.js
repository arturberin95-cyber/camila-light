document.addEventListener('DOMContentLoaded', function () {
  isMobile = {
    Android: function () {
      return navigator.userAgent.match(/Android/i);
    },
    BlackBerry: function () {
      return navigator.userAgent.match(/BlackBerry/i);
    },
    iOS: function () {
      return navigator.userAgent.match(/iPhone|iPad|iPod/i);
    },
    Opera: function () {
      return navigator.userAgent.match(/Opera Mini/i);
    },
    Windows: function () {
      return navigator.userAgent.match(/IEMobile/i);
    },
    any: function () {
      return (
        isMobile.Android() ||
        isMobile.BlackBerry() ||
        isMobile.iOS() ||
        isMobile.Opera() ||
        isMobile.Windows()
      );
    },
  };

  //burger logic

  $('.header__burger-span').click(() => {
    $('.header').toggleClass('active');
    $('body').toggleClass('overflow');
  });
  $('.header__list-link, .header__logo').click(() => {
    $('.header').removeClass('active');
    $('body').removeClass('overflow');
  });

  //header logic

  const header = document.querySelector('.header');
  let scrollPrev = 0;
  window.addEventListener('scroll', function () {
    let scrolled = window.scrollY;

    if (scrolled > 10 && scrolled > scrollPrev) {
      header.classList.add('hidden');
    } else {
      header.classList.remove('hidden');
    }

    scrollPrev = scrolled;
  });

  if (window.pageYOffset > 0) {
    header.classList.add('header--active');
  }

  (function () {
    const header = document.querySelector('.header');
    window.onscroll = () => {
      if (window.pageYOffset > 0) {
        header.classList.add('header--active');
      } else {
        header.classList.remove('header--active');
      }
    };
  })();

  // scroll to

  (function () {
    const smoothScroll = function (targetEl, duration) {
      const headerElHeight = 78;
      let target = document.querySelector(targetEl);
      let targetPosition = target.getBoundingClientRect().top - headerElHeight;
      let startPosition = window.pageYOffset;
      let startTime = null;

      const ease = function (t, b, c, d) {
        t /= d / 2;
        if (t < 1) return (c / 2) * t * t + b;
        t--;
        return (-c / 2) * (t * (t - 2) - 1) + b;
      };

      const animation = function (currentTime) {
        if (startTime === null) startTime = currentTime;
        const timeElapsed = currentTime - startTime;
        const run = ease(timeElapsed, startPosition, targetPosition, duration);
        window.scrollTo(0, run);
        if (timeElapsed < duration) requestAnimationFrame(animation);
      };
      requestAnimationFrame(animation);
    };

    const scrollTo = function () {
      const links = document.querySelectorAll('.js-scroll');
      links.forEach((each) => {
        each.addEventListener('click', function () {
          const currentTarget = this.getAttribute('href');
          smoothScroll(currentTarget, 1000);
        });
      });
    };
    scrollTo();
  })();

  //hero animation

  let observeAnchor = document.querySelectorAll('.hero__title-abs');

  let observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        setTimeout(() => {
          observeAnchor.forEach((link) => link.classList.add('active'));
        }, 1500);
      }
    });
  });

  observeAnchor.forEach((item) => observer.observe(item));
  //slick

  $('.people__wrapper.desktop').slick({
    infinite: false,
    speed: 300,
    slidesToShow: 1,
    slidesToScroll: 1,
    prevArrow: '.desktop .button--prev',
    nextArrow: '.desktop .button--next',
    variableWidth: true,
  });
  $('.people__wrapper.mobile').slick({
    infinite: false,
    speed: 300,
    slidesToShow: 1,
    slidesToScroll: 1,
    prevArrow: '.mobile .button--prev',
    nextArrow: '.mobile .button--next',
    variableWidth: true,
    centerMode: true,
  });
    $('.join__wrapper').slick({
    infinite: false,
    speed: 300,
    slidesToShow: 2,
    slidesToScroll: 1,
    prevArrow: '.join__buttons .button--prev',
    nextArrow: '.join__buttons .button--next',
    variableWidth: true,
    // responsive: [
    //     {
    //         breakpoint: 768, // Ширина экрана, при которой будут применяться эти настройки
    //         settings: {
    //             prevArrow: '.join__buttons-mob .button--prev', // Новый элемент для стрелки "назад" на мобильных устройствах
    //             nextArrow: '.join__buttons-mob .button--next', // Новый элемент для стрелки "вперёд" на мобильных устройствах
    //         }
    //     }
    // ]
  });

  // loader
  setTimeout(function () {
    document.querySelector('body').classList.remove('loaded');
  }, 400);

  //wow
  wow = new WOW({
    mobile: false, // default
  });
  wow.init();
  //prevent drag img and a
  const imagesAndLinks = document.querySelectorAll('img, a');
  if (imagesAndLinks) {
    imagesAndLinks.forEach(function (item, i, arr) {
      item.addEventListener('dragstart', function (e) {
        e.preventDefault();
      });
    });
  }

  const handlerResize = function () {
    let viewport_wid = viewport().width;
    let viewport_height = viewport().height;

    // if (viewport_wid <= 991) {

    // }
  };

  window.addEventListener('load', handlerResize);
  window.addEventListener('resize', handlerResize);
});

/* viewport width */
function viewport() {
  let e = window,
    a = 'inner';
  if (!('innerWidth' in window)) {
    a = 'client';
    e = document.documentElement || document.body;
  }
  return { width: e[a + 'Width'], height: e[a + 'Height'] };
}
/* viewport width */
